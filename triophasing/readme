#### complete genomics phasing writeup, author Vikas Bansal, last modified      Monday, June 14, 2010 12:53 PM

SNV detection and genotype calling:

We utilized the variation files generated by the Complete Genomics assembly of each individual in the trio. Positions called as SNPs in any one of the three individuals were identified.  This resulted in 4,465,277 single nucleotide variants at which at least one of the three individuals had one or more alleles different from the reference nucleotide (excluding Y chromosome).  For each position, we extracted the genotypes for each of three individuals from the variant files.  No-calls, 'ref-consistent' or 'ref-inconsistent' calls were treated as missing alleles.

Table on number of SNVs and indels identified in each individual:

Individual Sequence (Gb) # SNVs insertion/deletions
Child 121.9 3,162,427 144,944 + 156147
Mother 137.2 3,228,694 154,551 + 166060
Father  138.4 3,235,906 157195 + 169006
Combined  - 4,465,277 -


Phasing using Family data:

1.87 million variant sites were called as heterozygous in the child.  We used the family structure of the trio to infer the phase at these sites. The genotypes at 1.36 million of these sites were consistent with patterns of Mendelian inheritance and could be phased unambiguously using the parental genotypes. Genotypes at 134,263 sites were imputed in the child using the genotype calls from the mother and father.  About 7800 heterozygotes in the child were called as reference homozygote in both the parents indicating either the presence of a de novo mutation in the child or sequencing errors. 374,000 heterozygotes could not be phased since both the parents were also heterozygotes or one of the parents had a missing genotypes.

Phasing using population haplotype data from HapMap:

In order to infer the phase at sites that could not be phased using family data, we utilized phased haplotype data from the HapMap project.  We developed a simple algorithm to phase the unphased heterozygous sites in the child genome using haplotypes from the CEU HapMap population. Phased haplotypes for the CEU population were downloaded from the HapMap website. The variant sites in the child genome that overlapped with SNPs genotyped in the HapMap project were used for this analysis. Thus, only heterozygous variants that were genotyped in the HapMap  could be phased using this approach.

First, we determined the frequency of unique haplotype fragments in windows that spanned 2-5 heterozygous sites using the phased HapMap haplotypes. Using the haplotype fragment frequencies, we determined the most likely haplotype pair for the child genotypes in each window. We used the heterozygous sites that were phased using family data to constrain the set of feasible haplotype phasings. The score of the phasing in a window starting at the i-th heterozygous site and ending at the j-th heterozygous site was defined as log10(f1 x f2) where f1 and f2 were the haplotype frequencies of the pair of haplotype fragments corresponding to the most likely haplotype pair.  Given 'n' heterozygous sites (and homozygous sites in between) and the scores of windows, S(i,j) (1 <= i < n and j > i and j < i+5), we used a dynamic programming algorithm to determine the most likely pair of haplotypes for the 'n' heterozygous sites.

We define:   H(j) = max_i   ( H(i) + S(i,j) + delta )  where H(i) is the score of the best haplotype phasing of the first 'i' heterozygous sites and 'delta' is a penalty parameter to give lower weight to  phasings that use very short haplotype fragments. 'delta' was fixed at -1 for all sites. This dyanamic programming approach determined the two most likely haplotypes using the short haplotype fragments. The main motivation behind this approach was to develop a fast 'haplotype imputation' method that could be used to phase an individual's partially phased haplotypes.

We leveraged phased haplotypes from Hapmap2 as well as HapMap3. HapMap3 has an increased number of haplotypes for the CEU population (234 in comparison to 120 for HapMap2) however the number of genotyped SNPs is lower.  Additionally, the phased haplotypes were generated using different methods  To leverage the information from both these datasets, we first phased the individual's partially phased genotypes using HapMap2 haplotypes. The HapMap3 haplotypes were subsequently used to phase additional SNPs not genotyped by HapMap2.  Using this approach, approximately 40% of the unphased heterozygote sites could be phased onto the  heterozygous sites phased using family data. A large fraction of the HapMap3 SNPs were also genotyped in HapMap2, therefore using HapMap3 resulted in a marginal increase in the number of phased SNPs. In total, 88% of the heterozygote sites could be phased using a combination of family and population data.


Estimating accuracy of population-based phasing

To evaluate the accuracy of the population based haplotype phasing strategy outlined above, we utilized a simple 'in silico' approach. We used the HapMap data to determine phased haplotypes for the child ignoring family information. Using the phase at sites that could be unambiguously phased using family data alone, we estimated the switch error rate of the computationally phased haplotypes. For chromosome 1, the switch error rate was determined to be 2.68% using HapMap2 data. Interestingly, the switch error rate using HapMap3 haplotypes was slightly higher at 3.2 %. Switch error rate is expected to reduce with increased SNP density and increased number of phased haplotypes (Marchini et al, AJHG 2006). Although HapMap3 has almost twice the number of phased haplotypes, HapMap2 data has genotype information on 65% more SNPs than HapMap3.


To improve the accuracy of population phasing, we also determined the genotypes at HapMap SNPs that were not identified as a SNP in any of the three individuals. Including these additional genotypes reduced the switch error rate as compared to using genotypes at variant sites only, and is therefore expected to improve the overall accuracy of the haplotype phasing.

A large number of statistical and computational methods have been proposed for haplotype phasing from population genotype data. PHASE is perhaps the most accurate method among various methods. Beagle is a more recently proposed framework for haplotype phasing and genotype imputation that is computationally efficient for large scale phasing.  Beagle can also be used to phase an individual's genotypes using phased haplotype data from a reference population. We estimated the switch error rate of haplotype phasing using the individual genotypes using Beagle. The switch error rate using Beagle was 2.6%, virtually identical to the switch error rate using our method.


Phasing using data from the 1000 Genomes Project

About 40% of the variants that could not be phased using family information could be accurately phased using LD information from the HapMap project. However, the SNPs genotyped in the HapMap project represent only a subset of the common variants in human populations. The 1000 genomes project aims to sequence the complete genomes of ~ 1200 individuals at low sequence coverage, thereby providing a complete haplotype map of all common variants and a subset of rare variants.

Recently, variation and genotype data from the pilot phase of the 1000 Genomes Project has been made available. To evaluate the ability to phase variants using the 1000 Genomes data, we downloaded phased haplotypes for 60 CEU individuals made available by the University of Michigan. There were approximately 7.7 million SNPs in this dataset. For chromosome 1, 21,913 of the 27,435 (80%) of the unphased heterozygotes in the child were shared with the 1000 Genomes variants and could potentially be phased using LD information. In comparison, only 40 % of the heterozygous variants could be phased using HapMap data (phase I+II+III combined). This two-fold increase in the number of phased variants illustrates the advantage of leveraging population haplotypes inferred from whole-genome sequencing.  Another advantage of using the 1000 Genomes data is the ability to phase small insertion/deletion polymorphisms that is  infeasible using HapMap data.


Indel detection and genotyping:

Small insertion and deletion variants were identified from the Complete Genomics variant files. Similar to SNVs, we determined the genotype at each insertion/deletion variant for the three individuals.


Comparison of SNV genotype calls with array-based genotypes

One of the individuals in the family (HE00006) was also genotyped using the Illumina 1M genotyping chip. We compared genotype calls from the Illumina genotyping array with the sequencing-derived genotype calls at ~ 700,000 SNPs. For this, we utilized the Complete Genomics tools snpdiff that is explicitly designed to do this comparison.


Fraction of unphased variants as a function of population frequency

Given genotype information for a trio, a heterozygous variant in the child cannot be phased if both the parents are also heterozygous or if one or both of the parents have missing genotypes. The probability of the parental genotypes being missing is dependent on the sequencing or genotyping platform. In contrast, the likelihood of  the variant to be heterozygous in both the parents is a function of the minor allele frequency in the population. Formally, if p is the minor allele frequency, the conditional probability of the variant being heterozygous in both parents given that it is heterozygous in the child is:

P(both parents heterozygous | child is heterozygous) = Pr(all three individuals are heterozygous)/Pr(child is heterozygous) =

  p(1-p)p(1-p) * 0.5/ p(1-p) =  p(1-p)/2
